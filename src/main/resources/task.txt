Чтобы удалить Product и не напороться на constraint violation (он связан OTM с ProductDetail),
я должен сделать следующее:
- найти все ProductDetail, с которыми связан данный Product OTM, и удалить их;
- что касается Producer, то ему пофиг: хотя Product связан с ним MTO, у самого Producer нет колонки с id Product.
Теперь Product можно удалить.
Удаление связанных с ним ProductDetail:
- вначале пользуемся методом removeProductImages самого класса ProductDetail, стираем связи с картинками;
- потом удаляем.
------------------------------------------------------------------------------


// TODO: цена д.б. связана с ProductDetails, поскольку зависит от размера и т.п. И, кстати, картинок м.б. несколько для
// одного и того же товара, это НАДО ОТРАЗИТЬ В ТАБЛИЦЕ у админа.
//  Наконец, в таблице д.б. отражены также название и описание товара, так что в вышенаписанном (или новом) методе
//  контроллера нужно возвращать не ProductImage, а какой-нибудь ProductImageDTO с соответстующими деталями, и, наверное,
//  URL строить не через @PathVariable /{resourceId}, а через @RequestParam /image?id=...&details=true. И потом нужно
//  будет еще искать продукт по названию, если его нет - создавать новый, если есть - отображать табличку, и в качестве
//  details отображать все картинки, связанные с этим продуктом.

тест для популяции ProductDetail
контроллер для ProductDetail

на странице админа нужно отобразить:
(- еще для всего кнопки "спрятать результат")
- кнопку "Найти все изображения", сортировка по дате (самые новые наверху), по 20шт - отображает табличку, в которой,
в частности, отображены также уже связанные с картинкой ProductDetails, если есть. Сортировку также можно сделать
разной и добавить соответствующий список;
- поиск картинки по id и по имени (input);
- кнопку "Найти продукт" по имени и по дате, выдает строчки таблички с продуктами и вариантами их деталей (сортировка
также по имени и по дате);
- кнопку "Создать продукт" или "Новый продукт"

- сделать метод контроллера для загрузки не ПОЛНОГО изображения, а превью

Да! Я могу из JOIN запроса выбрать только distinkt image в ProductImageRepository, а потом следующим запросом по имаджу
получить список ProductDetails, а из них уже Product

Теперь сделать, чтобы запрос возвращал табличные записи "product.name, image.id", а хибернейт их клал в какую-нибудь
специальную энтити, для которой нет таблицы. Ну, или все через JDBC

В ProductJoinProductImageDTO добавить fileType для image



